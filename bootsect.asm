use16
org 0x7C00
start:
	mov ax, cs
	mov ds, ax
	mov ss, ax 
	mov sp, start 

	mov ah, 0x00
	mov al, 0x03
	int 0x10

load_drive:
    mov bx, 0x1000
    mov es, bx
    xor bx, bx
    mov al, 0x30
    mov dl, 0x01 
    mov dh, 0x00 
    mov ch, 0x00 
    mov cl, 0x01 
    mov ah, 0x02 
    int 0x13 

enable_protected_mode:
	cli
	lgdt[gdt_info]
	in al, 0x92
	or al, 2
	out 0x92, al
	mov eax, cr0
	or al, 1
	mov cr0, eax
	jmp 0x8:protected_mode 

gdt:
	db 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
	db 0xff, 0xff, 0x00, 0x00, 0x00, 0x9A, 0xCF, 0x00 
	db 0xff, 0xff, 0x00, 0x00, 0x00, 0x92, 0xCF, 0x00

gdt_info: 
	dw gdt_info - gdt
	dw gdt, 0

use32
protected_mode:
	mov ax, 0x10 
	mov es, ax
	mov ds, ax
	mov ss, ax
	call 0x10000 

times (512 -($ - $$) - 2) db 0
db 0x55, 0xAA 
